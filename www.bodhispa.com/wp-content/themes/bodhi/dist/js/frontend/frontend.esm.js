import{Accordion}from"../modules/module-accordion.js";import{initScrollAnimations}from"../modules/module-animations.js";import{loadCSS,loadJS}from"../modules/module-utilities.js";import initShare from"../modules/module-share.js";import initThankyou from"../modules/module-thankyou.js";const initHomePopup=()=>{let e=document.querySelector(".home");e&&setTimeout((()=>{jQuery(e).modaal({content_source:"#popup",custom_class:"popup--subscribe",start_open:!0,hide_close:!0,after_open:()=>{document.querySelector(".popup__close").addEventListener("click",(t=>jQuery(e).modaal("close")))}})}),3e3)},initHomeVideoHelper=()=>{let e=document.querySelector(".section--hero-front video");e&&e.play().catch((t=>{console.warn(t);let o=document.querySelector(".section--hero-front .backdrop__fallback").content.cloneNode(!0),r=e.parentElement;[...r.children].forEach((e=>e.remove())),r.appendChild(o.querySelector("img"))}))},initCartUpdater=()=>{jQuery(document).on("blur",".woocommerce-cart-form .voucher__field",(()=>{jQuery('.woocommerce-cart-form :input[name="update_cart"]').trigger("click")})),jQuery(document).on("click",".cart__actions .button--solid",(e=>{document.querySelector(".cart").reportValidity()||e.preventDefault()}))},initVideos=()=>{let e=document.querySelectorAll(".wp-video-shortcode");[...e].length&&(loadCSS("https://cdn.plyr.io/3.6.4/plyr.css",e[0].parentElement),loadJS("https://cdn.plyr.io/3.6.4/plyr.js",(()=>[...e].forEach((e=>new Plyr(e))))))};class Flyout{constructor(){this.toggle=document.querySelector(".flyout__toggle"),this.status="false",window.flyoutCallback&&this.toggle.removeEventListener("click",window.flyoutCallback),window.flyoutCallback=this.handlerCallback.bind(this),this.toggle.addEventListener("click",window.flyoutCallback)}handlerCallback(){this.status="true"===document.body.getAttribute("data-flyout"),this.toggle.setAttribute("aria-expanded",this.status?"false":"true"),document.body.setAttribute("data-flyout",this.status?"false":"true")}static handlerReset(){let e=document.querySelector(".flyout__toggle");document.body.setAttribute("data-flyout","false"),e.setAttribute("aria-expanded","false")}}const initFlyout=()=>new Flyout,initProductsFilter=(e,t)=>{let o=document.querySelector(".banner--products");if(o){let e,t=o.querySelector("ul");const r=()=>{e=t.querySelectorAll("select"),e.forEach((e=>e.addEventListener("change",l)))},l=e=>{window.location=e.target.children[e.target.selectedIndex].dataset.url};let n={brand:o.querySelector(".filter__template-brand"),category:o.querySelector(".filter__template-category")};const i=e=>{let t=n[document.forms.filter.filter.value].content.cloneNode(!0);window.location=t.querySelector("a").href};r(),document.forms.filter.filter.forEach((e=>{e.addEventListener("change",(()=>i(t)))}))}},initSliders=()=>{[...document.querySelectorAll(".slider")].length&&(loadCSS("https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css",document.body),loadJS("https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js",(()=>constructSliders())))},constructSliders=()=>{jQuery(".section__media--slider").slick({lazyLoad:"ondemand",dots:!0,arrows:!1,autoplay:!0,autoplaySpeed:5e3}),jQuery(".product__media--slider").slick({lazyLoad:"ondemand",dots:!0,arrows:!1}),jQuery(".section__content--slider").slick({prevArrow:".slider__navigation--prev",nextArrow:".slider__navigation--next",autoplay:!0,autoplaySpeed:7500,dots:!0,arrows:!0,responsive:[{breakpoint:768,settings:{arrows:!1}}]}),jQuery(".instagram__media--slider #sbi_images, .product__related--slider, .product__featured--slider").slick({dots:!1,arrows:!1,slidesToShow:5,slidesToScroll:5,autoplay:!1,autoplaySpeed:5e3,responsive:[{breakpoint:1440,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:2}}]})};let masonryInstance;const initShopMasonry=e=>{(e=e||document.querySelector(".width--content > .products"))&&(e=>{masonryInstance&&masonryInstance.remove(),masonryInstance=Macy({container:e,waitForImages:!1,margin:16,breakAt:{1100:{margin:12,columns:3},768:{margin:12,columns:2},320:{margin:8,columns:1}}}),masonryInstance.runOnImageLoad((()=>masonryInstance.recalculate(!0,!0)),!0)})(e)};window.almComplete=e=>initShopMasonry(e.content);let scroll_watch=()=>{document.body.dataset.hasScrolled=window.scrollY>50};document.addEventListener("DOMContentLoaded",scroll_watch),document.addEventListener("scroll",scroll_watch,{capture:!0,passive:!0}),document.addEventListener("DOMContentLoaded",(e=>{initHomeVideoHelper(),gsap.registerPlugin(ScrollTrigger,InertiaPlugin),initShopMasonry(),new Accordion({singularMode:!0,singularAllowHide:!0,hideExceptFirst:!1}),initScrollAnimations(),[...document.querySelectorAll(".slider")].length&&(loadCSS("https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css",document.body),loadJS("https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js",(()=>constructSliders()))),initShare(),initThankyou(),initProductsFilter(),jQuery(document).on("blur",".woocommerce-cart-form .voucher__field",(()=>{jQuery('.woocommerce-cart-form :input[name="update_cart"]').trigger("click")})),jQuery(document).on("click",".cart__actions .button--solid",(e=>{document.querySelector(".cart").reportValidity()||e.preventDefault()}))})),window.onload=function(){new Flyout,initVideos(),initHomePopup()};